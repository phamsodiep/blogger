<div id="entry_article">
<details class="hidden">
    <summary>
        <img
          border="0"
          data-original-width="1"
          data-original-height="1"
          width="1"
          height="1"
          src="https://2.bp.blogspot.com/-2of9KoZp8vc/Xp_w58hoeMI/AAAAAAAAAOE/-4LKN93rwEsDzD9rlvXjhANXUQwhHrqHQCLcBGAsYHQ/s1600/null.png"
        />
        <div id="entry_brief_tmp"><em><i>
            React is a JavaScript library for building Web user interfaces. It
            is maintained by Facebook. It supports renderring data to DOM
            programmatically. Template is composed by JSX, a Javascript
            extension supports embedded HTML. This blog entry shares some
            basic concepts and how to leverage frame work to build Line 98 line
            game step by step.<br />
            <br />
            <b>Audience:</b> software engineer with Javascript, CSS3 and UML
            knowledge – <b>Topic:</b> React programming
        </i></em></div>
    </summary>
    <p><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></p>
</details>


<div class="naturalsciencefont0">
    <div ID=" I. Create a project" class="para_sep1">
        <div>
            <b>I. Create a project</b>
        </div>
        <div ID=" I.1. Prerequisites">
            <div><b>1. Prerequisites</b></div>
            <div class="lindent0a">
                NodeJS
            </div>
        </div>
        <div ID=" I.2. Create a project" class="para_sep1">
            <div><b>2. Create a project</b></div>
            <div class="lindent00">
                <div>Launch below command:</div>
                <div class="lindent00">
                    npx create-react-app <i>line_98_game</i>
                </div>
                <div class="lindent0a">
                    <div>Where:</div>
                    <div class="lindent0b">
                        <i>line_98_game</i>: project name, it is also the
                        name of project folder
                    </div>
                </div>
            </div>
        </div>
        <div ID=" I.3. Run project" class="para_sep1">
            <div><b>3. Run project</b></div>
            <div class="lindent00">
                <div>
                    Switch current folder to project folder and launch below
                    command:
                </div>
                <div class="lindent00">
                    npx start
                </div>
                <div>
                    Open web browser to url <i>http://localhost:3000</i>
                    for test.
                </div>
                <div class="lindent0a">
                    <div>Notes:</div>
                    <div class="lindent0b">
                        <div>
                            To export project into static HTML files so that it
                            could be tested without NodeJS server. Launch below
                            command:
                        </div>
                        <div class="lindent00">
                            npx run build
                        </div>
                    </div>
                    <div class="lindent0b">
                        Exported static HTML files are located at folder:
                        <i>build</i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div ID=" II. Line 98 implementation introduction" class="para_sep1">
        <div>
            <b>II. Line 98 implementation introduction</b>
        </div>
        <div ID=" II.1. Introduction">
            <div><b>1. Introduction</b></div>
            <div class="lindent00">
                We will implement Line 98 game in React with design is located 
                at <i>https://huyj2ee.blogspot.com/2019/04/se-iconix-use-case-driven-design-case.html</i>
            </div>
        </div>
        <div ID=" II.2. Feature evolution" class="para_sep1">
            <div><b>2. Feature evolution</b></div>
            <div class="lindent00">
                We are implementing system with learning React intent. We start
                with no knowledge about React. To make thing easier for learning
                purpose, we will degrade system features and break down tasks,
                then implement them step by step with feature evolution.
            </div>
            <div class="lindent00">
                <div>System will evolute via version history as below:</div>
                <div class="lindent0a">
                    <i>0.1:</i>
                    On this version, user just sees a <i>Game Board</i>. No
                    interaction could be conducted.
                </div>
                <div class="lindent0a">
                    <div>
                        <i>0.2:</i>
                        On this version, use case <i>Reset Game</i>
                        is available.
                    </div>
                    <div class="lindent0b">
                        <i>0.2.1:</i>
                        Clicking reset <i>Button</i> triggers an alert message
                        <i>'Game reseting...'</i> showed.
                    </div>
                    <div class="lindent0b">
                        <i>0.2.2:</i>
                        Clicking reset <i>Button</i> results in system
                        initializes an <i>Game Board</i> with full of
                        <i>Ball</i>s rendered in cyan colour.
                    </div>
                </div>
                <div class="lindent0a">
                    <i>0.3:</i>
                </div>
            </div>
            <div class="lindent00">
                <div><i>Note:</i></div>
                <div class="lindent00">
                    Game algorithm is also ready in github for source
                    code copy/paste so that we could pay attention to React
                    learning. <br />
                    Link:
                    <a
                      target="_blank"
                      rel="noopener noreferrer"
                      href="https://github.com/phamsodiep/react_line_98_game"
                    >
                      https://github.com/phamsodiep/react_line_98_game
                    </a>
                </div>
            </div>
        </div>
    </div>
    <div ID=" III. Learning React by Line 98 implementation" class="para_sep1">
        <div>
            <b>III. Learning React by Line 98 implementation</b>
        </div>
        <div ID=" III.1. Basic concepts">
            <div><b>1. Basic concepts</b></div>
            <div ID=" III.1.1. JSX">
                <div><i>1.1. JSX</i></div>
                <div ID=" III.1.1.1 Concept" class="lindent00">
                    <div><i>1.1.1 Concept</i></div>
                    <div>
                        <div>JSX example:</div>
                        <div class="lindent00">





<textarea id="jsxsrc:1.1.1:1" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
const element = <h1>Line 98</h1>;</textarea>





                        </div>
                    </div>
                    <div>
                        React is developed in Javascript without real HTML tags.
                        JSX is an extension of Javascript to depicts HTML
                        template that React could understand. JSX is then
                        compiled into pure Javascript by NodeJS plug-in. JSX
                        needs compilation because it is neither Javascript
                        string or HTML.
                    </div>
                </div>
                <div ID=" III.1.1.2 JSX Expression" class="lindent00">
                    <div class="para_sep1"><i>1.1.2 JSX Expression</i></div>
                    <div>
                        <div>
                            JSX interprets Javascript expression (variables,
                            constants, functions...) to compose it into HTML
                            representation via JSX expression. For example:
                        </div>
                        <div class="lindent00">
                            <div>





<textarea id="jsxsrc:1.1.2:1" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
const name = 'Josh Perez';
const element = <h1>Hello, {name}</h1>;</textarea>





                            </div>
                            <div class="lindent0a">
                                <div>
                                    <i>{name}</i> is a JSX expression. The HTML
                                    representation of <i>{name}</i> will be
                                    substituted by value of Javascript variable
                                    named <i>name</i> which is <i>Josh Perez
                                    </i>. This is equivalent to below HTML
                                    rendering:
                                </div>
                                <div class="lindent00">





<textarea id="jsxsrc:1.1.2:2" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
<h1>Hello, Josh Perez</h1></textarea>





                                </div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <div>
                            Notes:
                        </div>
                        <div class="lindent0a">
                            <div>
                                Expression could be placed at attribute also:
                            </div>
                            <div class="lindent00">





<textarea id="jsxsrc:1.1.2:3" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
let url="http:/☯/localhost/nemo.jpg";
const imgEle = <im☯g src={url} />;</textarea>





                            </div>
                        </div>
                        <div class="lindent0a">
                            <div>
                                Expression value could also be a JSX
                                (nested JSX):
                            </div>
                            <div class="lindent00">





<textarea id="jsxsrc:1.1.2:4" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
let url="http:/☯/localhost/nemo.jpg";
const imgEle = <im☯g src={url} />;
const divEle = <div>{imgEle}<div>;</textarea>





                            </div>
                        </div>
                    </div>
                </div>
                <div ID=" III.1.1.3 React elements" class="lindent00">
                    <div class="para_sep1"><i>1.1.3 React elements</i></div>
                    <div>
                        <div>
                            Const or variable created by JSX is naturaly
                            Javascript Object type. For example of element
                            const:
                        </div>
                        <div class="lindent00">





<textarea id="jsxsrc:1.1.3:1" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
// Note: this structure is simplified
const element = {
  type: 'h1',
  props: {
    children: 'Line 98'
  }
}</textarea>





                        </div>
                        <div>
                            We call this as React element. React element is
                            just data of Object type not real DOM. We need to
                            invoke React render function to render this
                            element into HTML5 real DOM.
                        </div>
                    </div>
                </div>
            </div>
            <div ID=" III.1.2. React Component" class="para_sep1">
                <div><i>1.2. React Component</i></div>
                <div ID=" III.1.2.1. Purpose" class="lindent00">
                    <div>
                        <i>1.2.1. Purpose</i>
                    </div>
                    <div>
                        <div>
                            React Component is an encapsulation object to render
                            a chunks of HTML. For example GameBoard React
                            Component is designed to render HTML tags present
                            GameBoard include:
                        </div>
                        <div class="lindent0a">
                            A list of div tag presents cells of GameBoard which
                            user could click to (div tags listen to user's
                            onClick event).
                        </div>
                        <div class="lindent0a">
                            An background image presents cells boundary lines
                            (draws grid).
                        </div>
                    </div>
                </div>
                <div ID=" III.1.2.2. Definition" class="lindent00">
                    <div class="para_sep1">
                        <i>1.2.2. Definition</i>
                    </div>
                    <div>
                        <div>
                            React Component is an ES6 (new
                            version of Javascript that is supported by many
                            modern browsers) class that:
                        </div>
                        <div class="lindent0a">
                            Extends from React.Component class.
                        </div>
                        <div class="lindent0a">
                            Has render method return a JSX.
                        </div>
                        <div class="lindent0a">
                            Has properties and internal state (these concepts
                            will be explained in the next sections).
                        </div>
                        <div>
                            For example:
                        </div>
                        <div class="lindent00">





<textarea id="jsxsrc:1.2.2:1" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
class GameTitle extends React.Component {
  render() {
    return <h1>Line 98 </h1>;
  }
}</textarea>





                        </div>
                    </div>
                </div>
                <div ID=" III.1.2.3. Rendering" class="lindent00">
                    <div class="para_sep1">
                        <i>1.2.3. Rendering</i>
                    </div>
                    <div>
                        <div>
                            To render JSX:
                        </div>
                        <div class="lindent0b">
                            <div>
                                Create an element in HTML file and assign an id
                                to it. For example:
                            </div>
                            <div class="lindent00">





<textarea id="jsxsrc:1.2.3:1" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
<div id="line_98_title"></div></textarea>





</div>
                        </div>
                        <div class="lindent0b">
                            <div>
                                Invoke function ReactDOM.render to fill the
                                element content (.innerHTML) with React element
                                content as below:
                            </div>
                            <div class="lindent00">





<textarea id="jsxsrc:1.2.3:2" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
const element = <h1>Line 98</h1>;
ReactDOM.render(
  element,
  document.getElementById('line_98_title')
);</textarea>





                            </div>
                        </div>
                    </div>
                    <div class="lindent0a">
                        <div>
                            To render React Component:
                        </div>
                        <div class="lindent0b">
                            It is similar to rendering JSX because React
                            Component needs to be reprented as a JSX before
                            rendering.
                        </div>
                        <div class="lindent0b">
                            <div>JSX of GameTitle component is as below:</div>
                            <div class="lindent00">





<textarea id="jsxsrc:1.2.3:3" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
let gameTitleElem = <GameTitle />;
</textarea>





                            </div>
                        </div>
                        <div class="lindent0b">
                            <div>Then, we could render it:</div>
                            <div class="lindent00">





<textarea id="jsxsrc:1.2.3:4" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
ReactDOM.render(
  gameTitleElem,
  document.getElementById('line_98_title')
);</textarea>





                            </div>
                        </div>
                    </div>
                </div>
                <div ID=" III.1.2.4. Properties" class="lindent00">
                    <div class="para_sep1">
                        <i>1.2.4. Properties</i>
                    </div>
                    <div>
                        <div>
                            JSX expression could be placed at attribute also,
                            for JSX of React Component, these attributes
                            are accessed from Component (ES6 class) as
                            properties named as <i>props</i>. For example:
                        </div>
                        <div class="lindent00">





<textarea id="jsxsrc:1.2.3:5" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
let titleStr = "Line 98 Game";
let gameTitleElem = <GameTitle title={titleStr}/>;

ReactDOM.render(
  gameTitleElem,
   document.getElementById('line_98_title')
);</textarea>





                        </div>
                        <div class="lindent0a">
                            <div>
                                Where:
                            </div>
                            <div class="lindent0b">
                                <div>
                                    <i>title</i>={title}: <i>title</i> is an
                                    attribute of React Component GameTitle. It
                                    could be accessed in GameTitle class as
                                    <i>this.props.title</i>:
                                </div>
                                <div class="lindent00">
                                    <div class="lindent00">





<textarea id="jsxsrc:1.2.3:6" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
class GameTitle extends React.Component {
  render() {
    return <h1> this.props.title </h1>;
  }
}</textarea>





                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="lindent0a">
                            <div>
                                Note:
                            </div>
                            <div class="lindent0b">
                                Property is readonly that means that we could
                                not assign new value to <i>this.props.title</i>
                                in GameTitle class implementation.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div ID=" III.1.3. Exercises" class="para_sep1">
                <div><i>1.3. Exercises</i></div>
                <div ID=" III.1.3.1. Setup environments" class="lindent00">
                    <div>
                        <i>1.3.1. Setup environments</i>
                        <input
                          id="setup_env_131$"
                          class="view_switch"
                          type="button"
                          value="content is hidden"
                          onclick="switchDisplay(this, ['content is displayed', 'content is hidden']);"
                          title="click to show/hide Setup environments content"
                        />





<div class="setup_env_131$content_is_displayed" style="display: none;">





                        <div>
                            <div>
                                We will create a project name <i>line_98_game</i> by
                                following instructions in section <i>I. Create a
                                project</i> then implement a very simple code to
                                test. The code will render a h1 tag with
                                "Hello, world!" text in italic. Follow below
                                steps for implementation, github source code is
                                also available at
                                <a
                                  target="_blank"
                                  rel="noopener noreferrer"
                                  href="https://github.com/phamsodiep/react_line_98_game/commit/2e2fb708b6568167e8449c1dfcc56257da6a5cdb"
                                >
                                  link.
                                </a>
                            </div>
                            <div class="lindent0a">
                                <div>
                                    Create project with below command:
                                </div>
                                <div class="lindent00">
                                    npx create-react-app <i>line_98_game</i>
                                </div>
                            </div>
                            <div class="lindent0a">
                                <div>
                                    Move or delete all files of below folders:
                                </div>
                                <div class="lindent0b">
                                    public
                                </div>
                                <div class="lindent0b">
                                    src
                                </div>
                            </div>
                            <div class="lindent0a">
                                <div>
                                    Create an HTML file named <i>index.html</i>
                                    in folder <i>public</i> for a div entry with
                                    an id of value "line98EntryPoint" so that
                                    ReactDOM.render could render to.
                                </div>
                                <div class="lindent00">





<textarea id="jsxsrc:1.3.1:1" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
<!DOCTYPE html>
<html lang="en">
 <head>
    <meta charset="utf-8" />
    <title>Line 98</title>
  </head>
  <body>
    <div id="line98EntryPoint"></div>
  </body>
</html></textarea>





                                </div>
                            </div>
                            <div class="lindent0a">
                                <div>
                                    Create a Javascript file named <i>index.js</i>
                                    in folder <i>src</i> for React source code
                                    implementation.
                                </div>
                                <div class="lindent00">





<textarea id="jsxsrc:1.3.1:2" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
import React from 'react';
import ReactDOM from 'react-dom';

let msgElem = <i>Hello, world!</i>;
ReactDOM.render(
  <h1>{msgElem}</h1>,
  document.getElementById('line98EntryPoint')
);</textarea>





                                </div>
                                <div>
                                    <i>Note</i>:
                                    We need to import <i>React</i> and ReactDOM for
                                    basic React libraries.
                                </div>
                            </div>
                            <div class="lindent0a">
                                <div>
                                    Launch below command to start NodeJS server:
                                </div>
                                <div class="lindent00">
                                    npx start
                                </div>
                            </div>
                            <div class="lindent0a">
                                <div>
                                    Open web browser to below url for test:
                                </div>
                                <div class="lindent00">
                                    http://localhost:3000/
                                </div>
                            </div>
                        </div>





</div>





                    </div>
                </div>
                <div ID=" III.1.3.2. Implement Hello component" class="lindent00">
                    <div class="para_sep1">
                        <i>1.3.2. Implement Hello component</i>
                        <input
                          id="impl_hello_comp$"
                          class="view_switch"
                          type="button"
                          value="content is hidden"
                          onclick="switchDisplay(this, ['content is displayed', 'content is hidden']);"
                          title="click to show/hide mplement Hello component content"
                        />





<div class="impl_hello_comp$content_is_displayed" style="display: none;">





                        <div>
                            <div class="lindent0a">
                                <div>
                                    Create class <i>Hello</i> extends
                                    <i>React.Component</i> with <i>render()</i>
                                    method in source code file <i>index.js</i>
                                    as below, then follow steps of section
                                    <i>1.3.1. Setup environments</i> for test.
                                    Github source code is also available at
                                    <a
                                      target="_blank"
                                      rel="noopener noreferrer"
                                      href="https://github.com/phamsodiep/react_line_98_game/commit/6a8ddde0a714c77fe8c5d4639aa8d3c90bd4242a"
                                    >
                                      link.
                                    </a>
                                </div>
                                <div class="lindent00">





<textarea id="jsxsrc:1.3.2:1" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
import React from 'react';
import ReactDOM from 'react-dom';

class Hello extends React.Component {
  render() {
    let msgElem = <i>Hello, world!</i>;
    return <h1>{msgElem}</h1> ;
  }
}
ReactDOM.render(
  <Hello />,
  document.getElementById('line98EntryPoint')
);</textarea>





                                </div>
                            </div>
                        </div>





</div>





                    </div>
                </div>
            </div>
        </div>
        <div ID=" III.2. Component Lifecycle Methods" class="para_sep1">
            <div><b>2. Component Lifecycle Methods</b></div>
            <div ID=" III.2.1. Mounting and Unmounting">
                <div><i>2.1. Mounting and unmounting</i></div>
                <div class="lindent0a">
                    <i>Mounting</i> is behavior renders component to real DOM
                    for the first time.
                </div>
                <div class="lindent0a">
                    <i>Unmounting</i> is behavior remove component from real
                    DOM.
                </div>
            </div>
            <div ID=" III.2.2. Lifecycle Methods" class="para_sep1">
                <div><i>2.2. Lifecycle methods</i></div>
                <div class="lindent00">
                    <div>
                        <i>Lifecycle methods</i> are methods of component class
                        is invoked when a component mounts and unmounts.
                        They are:
                    </div>
                    <div class="lindent0a">
                        <i>componentDidMount()</i>: method is invoked after the
                        component output has been rendered to the DOM.
                    </div>
                    <div class="lindent0a">
                        <i>componentWillUnmount()</i>: method is invoked
                        immediately before a component is unmounted and
                        destroyed
                            <a
                              target="_blank"
                              rel="noopener noreferrer"
                              href="https://stackoverflow.com/questions/40760308/how-to-properly-use-componentwillunmount-in-reactjs"
                            >
                              (stack overflow).
                            </a>
                    </div>
                </div>
            </div>
            <div ID=" III.2.3. Exercises" class="para_sep1">
                <div><i>2.3. Exercises</i></div>
                <div class="lindent00">
                    <div>
                        Implement version 0.1.0
                        <input
                          id="impl_ver_010$"
                          class="view_switch"
                          type="button"
                          value="content is hidden"
                          onclick="switchDisplay(this, ['content is displayed', 'content is hidden']);"
                          title="click to show/hide Implement version 0.1.0 content"
                        />





<div class="impl_ver_010$content_is_displayed" style="display: none;">





                        <div>
                            <div class="lindent0a">
                                As SDD – Software design description,
                                <a
                                  target="_blank"
                                  rel="noopener noreferrer"
                                  href="https://huyj2ee.blogspot.com/2019/04/se-iconix-use-case-driven-design-case.html#fig_designed_class_diag"
                                >
                                  <b>Figure</b> 3.3.2.1:
                                  <i>System overview class diagram</i>,
                                </a>
                                <i>GameBoard</i> stereotype is <i>Boundary</i>.
                                Thus, we will implement class <i>GameBoard</i>
                                as React Component.
                            </div>
                            <div class="lindent0a">
                                As <i>II.2. Feature evolution</i> section,
                                <i>GameBoard</i> just needs to draw cells.
                                To draw cells we need a <i>Canvas</i> tag
                                which is then, rendered programmatically in
                                Javascript. It is a real DOM manipulation
                                so we need to hook to method
                                <i>componentDidMount()</i> for such real DOM
                                ready.
                            </div>
                            <div class="lindent0a">
                                <div>
                                    Implementation steps is as below, github
                                    source code is also available at
                                    <a
                                      target="_blank"
                                      rel="noopener noreferrer"
                                      href="https://github.com/phamsodiep/react_line_98_game/commit/6925ee6cc978240b4895153e7ac9554343d954b5"
                                    >
                                      link.
                                    </a>
                                </div>
                                <div class="lindent0b">
                                    <div>
                                        Remove class <i>Hello</i> implementation
                                        and replace it with class
                                        <i>GameBoard</i> implementation as
                                        below:
                                    </div>
                                    <div class="lindent0c">
                                        Implement <i>render()</i> method
                                        to render two divs and one canvas:
                                        <div class="lindent0c">
                                            Div <i>gameBoard</i> houses
                                            canvas and future <i>Ball</i>
                                            component which is not available
                                            in this version. This div layouts
                                            its child elements in
                                            <i>relative</i> position.
                                        </div>
                                        <div class="lindent0c">
                                            Div <i>container</i> houses div
                                            <i>gameBoard</i>. We need this div
                                            to make div <i>gameBoard</i> is
                                            compatiable with default layout
                                            of webpage.
                                        </div>
                                        <div class="lindent0c">
                                            Canvas <i>gameboard_bg</i> element
                                            render GameBoard's grid. We need a
                                            canvas for rendering instead of
                                            a grid of divs for simplicity
                                            (reduce number of elements in
                                            webpage).
                                        </div>
                                    </div>
                                    <div class="lindent0c">
                                        <div>
                                            Implement method
                                            <i>componentDidMount()</i>
                                            to render grid in canvas:
                                        </div>
                                        <div class="lindent0c">
                                            We can not render canvas in
                                            <i>render()</i> method because JSX
                                            is virtual DOM, not real DOM. Within
                                            <i>render()</i> method, the canvas
                                            does not exist.
                                        </div>
                                        <div class="lindent0c">
                                            We assign canvas with id of value
                                            <i>gameboard_bg</i> so that method
                                            <i>componentDidMount()</i> could
                                            refer to.
                                        </div>
                                    </div>
                                </div>
                                <div class="lindent0b">
                                    <div>
                                        Result source code is as below:
                                    </div>
                                    <div>





<textarea id="jsxsrc:2.3.2:1" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
import React from 'react';
import ReactDOM from 'react-dom';


class GameBoard extends React.Component {
  componentDidMount() {
    let bgImg = document.getElementById("gameboard_bg");
    if (bgImg === null) return;
    let i = 0;
    let n = 9; // dimension
    let thick = 1;
    let cellSize = 50;
    let width = n * cellSize + thick * (n + thick);

    // Context retrieving and initializing
    bgImg.width = width;
    bgImg.height = width;
    bgImg.style.position = "absolute";
    bgImg.style.left = 0;
    bgImg.style.top = 0;
    let canvasContext = bgImg.getContext("2d");
    canvasContext.translate(0, 0);
    canvasContext.lineWidth = 1;

    // Render board surface
    canvasContext.fillStyle = "#eeeeee";
    canvasContext.fillRect(
      0,
      0,
      width,
      width
    );

    // Render board cells border
    // |  |  |...
    canvasContext.fillStyle = "#000000";
    for (i = 0; i <= n; i++) {
      let x = i * (cellSize + thick);
      canvasContext.fillRect(x, 0, thick, width);
    }
    // =
    for (i = 0; i <= n; i++) {
      let y = i * (cellSize + thick);
      canvasContext.fillRect(0, y, width, thick);
    }
  }

  render() {
    // dimension * cellSize + lineWidth * (dimension + 1)
    let width = 9 * 50 + 1 * (9 + 1);
    let gameBoardStyle = {
      position: "relative",
      width: "100%",
      height: "100%",
      borderWidth: "0px",
      borderStyle: "none",
      margin: "0px 0px 0px 0px",
      padding: "0px 0px 0px 0px"
    };
    let containerStyle = {
      position: "static",
      width: width + "px",
      height: width + "px",
      borderWidth: "0px",
      borderStyle: "none",
      margin: "0px 0px 0px 0px",
      padding: "0px 0px 0px 0px"
    };
    return (
      <div style={containerStyle}>
        <div style={gameBoardStyle}>
          <canvas id="gameboard_bg">
          </canvas>
        </div>
      </div>
    );
  }
}

ReactDOM.render(
  <GameBoard />,
  document.getElementById('line98EntryPoint')
);</textarea>





                                    </div>
                                    <br />
                                    <input
                                      class="view_switch"
                                      type="button"
                                      value="hide exercise"
                                      onclick="document.getElementById('impl_ver_010$').click();"
                                      title="click to hide Implement version 0.1.0 exercise"
                                    />
                                </div>
                            </div>
                        </div>





</div>





                    </div>
                </div>
            </div>
        </div>
        <div ID=" III.3. Refs and the DOM" class="para_sep1">
            <div><b>3. Refs and the DOM</b></div>
            <div ID=" III.3.1. Purpose">
                <div>
                    <i>3.1 Purpose</i>
                </div>
                <div class="lindent00">
                    <div>
                        Refs provide a way to access real HTML DOM nodes or
                        React component created in the render method. This
                        is meaningful to:
                    </div>
                    <div class="lindent0a">
                        Managing focus, text selection, or media playback. In
                        our Line 98 game case, we could access to canvas real
                        HTML DOM node via ref instead of via its declared id
                        <i>gameboard_bg</i>.
                    </div>
                    <div class="lindent0a">
                        Integrating with third-party DOM libraries.
                    </div>
                    <div class="lindent0a">
                        Triggering imperative animations.
                    </div>
                </div>
            </div>
            <div ID=" III.3.2. Steps to create a ref" class="para_sep1">
                <div>
                    <i>3.2 Steps to create a ref</i>
                </div>
                <div class="lindent00">
                    <div>
                        <i>3.2.1 Create with React.createRef()</i>
                    </div>
                    <div class="lindent0a">
                        <div>
                            Create a ref in <i>constructor</i> method by
                            <i>React.createRef()</i> method, assign it to
                            Component property for later access:
                        </div>
                        <div class="lindent00">





<textarea id="jsxsrc:3.2.1:1" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
constructor(props) {
  super(props);
  this.myRef = React.createRef(); // assign it to Component property named myRef for later access
}</textarea>





                        </div>
                    </div>
                    <div class="lindent0a">
                        <div>
                            Assign property <i>myRef </i> to <i>ref</i> JSX
                            attribute in method <i>render()</i>:
                        </div>
                        <div class="lindent00">





<textarea id="jsxsrc:3.2.1:2" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
render() {
  return <Hello ref={this.myRef} />;
}</textarea>





                        </div>
                    </div>
                </div>
                <div class="lindent00">
                    <div class="para_sep1">
                        <i>3.2.2 Let React creates it silently, then access it
                        via callback function</i>
                    </div>
                    <div class="lindent0a">
                        <div>
                            Declare a bind call back function as a hook for
                            access:
                        </div>
                        <div class="lindent00">





<textarea id="jsxsrc:3.2.2:1" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
onDivCreate = (elem) => {
  let _th☯is = this;
  elem.onclick = function () {
    alert(_th☯is.msg);
  }
}</textarea>





                        </div>
                    </div>
                    <div class="lindent0a">
                        <div>
                            Assign this call back function to target element's
                            JSX attribute:
                        </div>
                        <div class="lindent00">





<textarea id="jsxsrc:3.2.2:2" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
render() {
  this.msg = "Hello, Pham So Diep!";
  return <div ref={this.onDivCreate}>Click me fo☯r a hello message</div> ;
}</textarea>





                        </div>
                    </div>
                </div>
            </div>
            <div ID=" III.3.3. Access to ref" class="para_sep1">
                <div>
                    <i>3.3. Access to ref</i>
                </div>
                <div ID=" III.3.3.1 Life cycle" class="lindent00">
                    <div>
                        <i>3.3.1 Lifecycle</i>
                    </div>
                    <div>
                        <div>
                            <it>Ref</it> could be created in <i>constructor</i>
                            method implemenation, but it target reference is
                            only available after <i>render()</i> method
                            invoking. Thus, access should be done at
                            component lifecycle call back method 
                            <i>componentDidMount</i> for such availability.
                            For example, in method <i>componentDidMount</i>
                            implementation of below source code example, the
                            reference could be accessed via <i>current</i> 
                            property, so once the div tag is clicked, message
                            <i>"Hello, Pham Duc Huy!"</i> is showed instead of
                            the default one <i>"Hello, Pham So Diep!"</i>:
                            <input
                              id="snippet_331_life_cycle$"
                              class="view_switch"
                              type="button"
                              value="content is hidden"
                              onclick="switchDisplay(this, ['content is displayed', 'content is hidden']);"
                              title="click to show/hide example source code content"
                            />
                        </div>
                        <div class="lindent00">





<div class="snippet_331_life_cycle$content_is_displayed" style="display: none;">





<textarea id="jsxsrc:3.3.1:1" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">

import React from 'react';
import ReactDOM from 'react-dom';


class Hello extends React.Component {
  onDivCreate = (elem) => {
    let _th☯is = this;
    elem.onclick = function () {
      alert(_th☯is.msg);
    }
  }

  render() {
    this.msg = "Hello, Pham So Diep!";
    return <div ref={this.onDivCreate}>Click me fo☯r a hello message</div> ;
  }
}

class HelloContainer extends React.Component {
  constructor(props) {
    super(props);
    this.myRef = React.createRef(); // assign it to Component property for later access
  }

  render() {
    return <Hello ref={this.myRef}/>;
  }

  componentDidMount() {
    this.myRef.current.msg =
      "Hello, Pham Duc Huy!"; // the reference could be accessed via current property
  }
}

ReactDOM.render(
  <HelloContainer />,
  document.getElementById('line98EntryPoint')
);</textarea>





                            <br />
                            <input
                              class="view_switch"
                              type="button"
                              value="hide example source code"
                              onclick="document.getElementById('snippet_331_life_cycle$').click();"
                              title="click to hide example source code content"
                            />
</div>
                        </div>
                    </div>
                </div>
                <div ID=" III.3.3.2 Real HTML DOM node or React component" class="lindent00">
                    <div class="para_sep1">
                        <i>3.3.2 Real HTML DOM node or React component</i>
                    </div>
                    <div>
                        <div>
                            Object that Ref references to could be a real HTML
                            DOM node or React component. This depends to the JSX
                            of the refs attribute. In the case of JSX of HTML
                            tag, Ref references to real HTML DOM node, in the
                            case of JSX of React component, Ref references to
                            that React component. For example, in source code
                            example of section 3.3.1 Life cycle,
                        </div>
                        <div class="lindent0a">
                            <div>
                                JSX of HTML tag:
                            </div>
                            <div class="lindent00">





<textarea id="jsxsrc:3.3.2:1" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
<div ref={this.onDivCreate}>Click me fo☯r a hello message</div></textarea>





                            </div>
                            <div>
                                Ref references to a real HTML DOM node.
                                <i>onclick</i> is event hander call back
                                function of real HTML DOM node:
                            </div>
                            <div class="lindent00">





<textarea id="jsxsrc:3.3.2:2" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
onDivCreate = (elem) => {
  let _thi☯s = this;
  elem.onclick = function () {
    alert(_this.msg);
  }
}</textarea>





                            </div>
                            <div>
                                <i>Note:</i> We could also access to
                                <i>elem.innerHTML</i> to alter div text content
                                if we need.
                            </div>
                        </div>
                        <div class="lindent0a">
                            <div>
                                JSX of React component:
                            </div>
                            <div class="lindent00">





<textarea id="jsxsrc:3.3.2:3" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
<Hello ref={this.myRef}/>;</textarea>





                            </div>
                            <div>
                                Ref references to React component.
                                <i>this.myRef.current</i> is reference of Hello
                                component. We altered <i>msg</i> property of
                                this component for alert message decoration:
                            </div>
                            <div class="lindent00">





<textarea id="jsxsrc:3.3.2:4" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
componentDidMount() {
  this.myRef.current.msg =
    "Hello, Pham Duc Huy!"; // the reference could be accessed via current property
}</textarea>





                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div ID=" III.3.4. Best practices" class="para_sep1">
                <div>
                    <i>3.4 Best practices</i>
                </div>
                <div class="lindent00">
                    <div>
                        Don't Overuse Refs, because they manipulate on real DOM
                        and/or not follow React default dataflow behavior.
                    </div>
                    <div class="lindent0a">
                        Avoid <i>ref</i> callback is defined as an inline
                        function, use bound method instead.
                    </div>
                    <div class="lindent0a">
                        Avoid to use the <i>ref</i> attribute on function
                        components (function components is component that is
                        declared as Javascript function instead of ES6 class).
                    </div>
                </div>
            </div>
            <div ID=" III.3.5. Exercise" class="para_sep1">
                <div>
                    <i>3.5 Exercise</i>
                </div>
                <div>
                    <div class="lindent00">
                        We will develop Line 98 version 0.1.0 further to
                        version 0.1.1 in exercise 3.5.1, then to version 0.1.2.
                        in exercise 3.5.2. New verions try to remove id
                        <i>gameboard_bg</i> of canvas by implementing with
                        React Ref. Such removal is very helpfull if we need two
                        instances of Line 98 game in one web page.
                    </div>
                    <div ID=" III.3.5.1 Exercise" class="lindent00">
                        <div class="para_sep1">
                            <i>3.5.1 Leverage React Ref to remove id
                            gameboard_bg of canvas element</i>
                            <input
                              id="impl_exer_351$"
                              class="view_switch"
                              type="button"
                              value="content is hidden"
                              onclick="switchDisplay(this, ['content is displayed', 'content is hidden']);"
                              title="click to show/hide source code implementation of exercise 3.5.1"
                            />
                        </div>





<div class="impl_exer_351$content_is_displayed" style="display: none;">





                        <div>
                            <div>
                                Implementation steps are as below,
                                github source code is also available at
                                <a
                                  target="_blank"
                                  rel="noopener noreferrer"
                                  href="https://github.com/phamsodiep/react_line_98_game/commit/5ff385d449f389ed863bc9d22986c6d2cd5085b4"
                                >
                                  link.
                                </a>
                            </div>
                            <div class="lindent0a">
                                <div>
                                    Implement <i>constructor</i> method to
                                    create gameboardBgRef
                                </div>
                                <div class="lindent00">





<textarea id="jsxsrc:3.5.1:1" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
constructor(props) {
  super(props);
  this.gameboardBgRef = React.createRef();
}</textarea>





                                </div>
                            </div>
                            <div class="lindent0a">
                                <div>
                                    Replace <i>canvas</i>'s HTML id with its
                                    React <i>ref</i> attribute:
                                </div>
                                <div class="lindent00">
<textarea id="jsxsrc:3.5.1:2" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
render() {
  .....

  return (
    <div style={containerStyle}>
      <div style={gameBoardStyle}>
        <canvas ref={this.gameboardBgRef}>
        </canvas>
      </div>
    </div>
  );
}</textarea>
                                </div>
                            </div>
                            <div class="lindent0a">
                                <div>
                                    Retrieve <i>bgImg</i> in method
                                    <i>componentDidMount()</i> implementation
                                    by <i>this.gameboardBgRef.current;</i>
                                    instead of previous version one
                                    <i>
                                        document.getElementById("gameboard_bg")
                                    </i>:
                                </div>
                                <div class="lindent00">
<textarea id="jsxsrc:3.5.1:3" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
componentDidMount() {
  //let bgImg = document.getElementById("gameboard_bg");
  let bgImg = this.gameboardBgRef.current;
  //if (bgImg === null) return;
  let i = 0;

  .....
}</textarea>
                                </div>
                            </div>
                        </div>








</div>





                    </div>
                    <div ID=" III.3.5.2 Exercise" class="lindent00">
                        <div class="para_sep1">
                            <i>3.5.2 Alternative solution of 3.5.1 with out
                            implementing method componentDidMount</i>
                            <input
                              id="impl_exer_352$"
                              class="view_switch"
                              type="button"
                              value="content is hidden"
                              onclick="switchDisplay(this, ['content is displayed', 'content is hidden']);"
                              title="click to show/hide source code implementation of exercise 3.5.2"
                            />
                        </div>





<div class="impl_exer_352$content_is_displayed" style="display: none;">





                        <div>
                            <div>
                                Implementation steps are as below,
                                github source code is also available at
                                <a
                                  target="_blank"
                                  rel="noopener noreferrer"
                                  href="https://github.com/phamsodiep/react_line_98_game/commit/ddf90a64f8812f42b144945be0c366412c4c4cf5"
                                >
                                  link.
                                </a>
                            </div>
                            <div class="lindent0a">
                                <div>
                                    In method <i>render()</i> implementation,
                                    replace attribute <i>ref</i> of
                                    <i>canvas</i> from
                                    <i>this.gameboardBgRef</i>
                                    to <i>onCanvasCreate</i>:
                                </div>





<textarea id="jsxsrc:3.5.2:1" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
render() {
  .....

  return (
    <div style={containerStyle}>
      <div style={gameBoardStyle}>
        <canvas ref={this.onCanvasCreate}>
        </canvas>
      </div>
    </div>
  );
}</textarea>





                            </div>
                            <div class="lindent0a">
                                Remove method <i>constructor</i> implementation
                                since we do not need <i>this.gameboardBgRef</i>
                                anymore.
                            </div>
                            <div class="lindent0a">
                                <div>
                                    Refactor by renaming method
                                    <i>componentDidMount</i> to
                                    <i>onCanvasCreate</i> as a bind call back
                                    function, since we do not
                                    need this method is invoked in such
                                    lifecycle anymore, and change access to
                                    <i>bgImg</i> as below:
                                </div>





<textarea id="jsxsrc:3.5.2:2" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
//componentDidMount() {
onCanvasCreate = (bgImg) => {
  //let bgImg = this.gameboardBgRef.current;
  let i = 0;

  .....
}</textarea>





                            </div>
                        </div>





</div>





                    </div>
                </div>
            </div>
        </div>
        <div ID=" III.4. Handling Events" class="para_sep1">
            <div><b>4. Handling Events</b></div>
            <div ID=" III.4.1 Introduction">
                <div>
                    <i>4.1 Introduction</i>
                </div>
                <div class="lindent00">
                    We could handle events on real HTML DOM elements by Ref,
                    but it is not recommended to do that because of React
                    dataflow and React component data access (properties,
                    states...). Handling events with React elements is very
                    similar to handling events on DOM elements, with some
                    difference that is introduced in following section.
                </div>
            </div>
            <div ID=" III.4.2 Programming" class="para_sep1">
                <div>
                    <i>4.2 Programming</i>
                </div>
                <div ID=" III.4.2.1 JSX declartion" class="lindent00">
                    <div>
                        <i>4.2.1 JSX declartion:</i>
                    </div>
                    <div>
                        <div>
                            Events declartion syntax for JSX is as below:
                        </div>
                        <div class="lindent0a">
                            React events are named using camelCase, rather
                            than lowercase.
                        </div>
                        <div class="lindent0a">
                            With JSX you pass a function as the event handler,
                            rather than a string.
                        </div>
                    </div>
                    <div>
                        <div>
                            Example:
                        </div>
                        <div class="lindent00">
                            <div>





<textarea id="jsxsrc:4.2.1:1" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
<button onClick={this.resetGame}>
  Reset
</button></textarea>





                            </div>
                        </div>
                    </div>
                </div>
                <div ID=" III.4.2.2 Handling Events method programming" class="lindent00">
                    <div class="para_sep1">
                        <i>4.2.2 Handling Events method programming:</i>
                    </div>
                    <div>
                        <div class="lindent0a">
                            <div>
                                To handle event without <i>this</i>
                                refrence access.
                            </div>
                            <div class="lindent00">





<textarea id="jsxsrc:4.2.1:2" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
resetGame() {
  alert('Type of thi☯s is ' + (typeof this));
}
</textarea>






                            </div>
                        </div>
                        <div class="lindent0a">
                            <div>
                                To handle event with <i>this</i>
                                refrence access to React component, we need to
                                bind the method to <i>this</i>.
                            </div>
                            <div class="lindent00">





<textarea id="jsxsrc:4.2.1:3" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
resetGame = () => {
  alert('Type of thi☯s is ' + (typeof this));
}
</textarea>





                            </div>
                        </div>
                        <div class="lindent0a">
                            <div>
                                To pass <i>parameters</i> to handle event, we
                                need to bind the method to <i>parameters</i>
                                too. The <i>this</i> reference must be the first
                                binded <i>parameter</i>.
                                <input
                                  id="parameters_event_demo_421$"
                                  class="view_switch"
                                  type="button"
                                  value="content is hidden"
                                  onclick="switchDisplay(this, ['content is displayed', 'content is hidden']);"
                                  title="click to show/hide source code example"
                                />
                            </div>





<div class="parameters_event_demo_421$content_is_displayed" style="display: none;">





                            <div class="lindent00">





<textarea id="jsxsrc:4.2.1:4" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
import React from 'react';
import ReactDOM from 'react-dom';

class ResetButton extends React.Component {
  constructor(props) {
    super(props);
  }

  resetGame = (id) => {
    alert('Type of thi☯s: ' + (typeof this) + ' - id: ' + id);
  }

  render() {
    let id = 1998;
    return (
      <button onClick={(reactEventObj) => this.resetGame(id)}>
        Reset
      </button>
    );
  }
}

ReactDOM.render(
  <ResetButton />,
  document.getElementById('line98EntryPoint')
);</textarea>





                            </div>





</div>





                        </div>
                    </div>
                </div>
                <div ID=" III.4.2.3 Event propagation" class="lindent00">
                    <div class="para_sep1">
                        <i>4.2.3 Event propagation:</i>
                    </div>
                    <div class="lindent0a">
                        <div>
                            Event is propagated from inner element to
                            outer element:
                            <input
                              id="propagation_demo_423$"
                              class="view_switch"
                              type="button"
                              value="content is hidden"
                              onclick="switchDisplay(this, ['content is displayed', 'content is hidden']);"
                              title="click to show/hide source code example"
                            />
                        </div>





<div class="propagation_demo_423$content_is_displayed" style="display: none;">





                        <div class="lindent00">





<textarea id="jsxsrc:4.2.3:1" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
import React from 'react';
import ReactDOM from 'react-dom';


class ResetButton extends React.Component {
  constructor(props) {
    super(props);
  }

  resetGame = (id, eventObj) => {
    alert('Type of thi☯s: ' + (typeof this) + ' - id: ' + id);
  }

  render() {
    let divCallBackFunc = function () {
      alert('hi! I am div tag');
    };
    let id = 1998;
    return (
      <div onClick={divCallBackFunc}>
        <button onClick={(reactEventObj) => this.resetGame(id, reactEventObj)}>
          Reset
        </button>
      </div>
    );
  }
}

ReactDOM.render(
  <ResetButton />,
  document.getElementById('line98EntryPoint')
);</textarea>





                        </div>





</div>





                    </div>
                    <div class="lindent0a">
                        <div class="para_sep1">
                            To stop event propagation from inner element, invoke
                            method <i>stopPropagation</i>.
                            <input
                              id="stop_propagation_423$"
                              class="view_switch"
                              type="button"
                              value="content is hidden"
                              onclick="switchDisplay(this, ['content is displayed', 'content is hidden']);"
                              title="click to show/hide source code example"
                            />
                        </div>





<div class="stop_propagation_423$content_is_displayed" style="display: none;">





                        <div class="lindent00">





<textarea id="jsxsrc:4.2.3:2" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
import React from 'react';
import ReactDOM from 'react-dom';


class ResetButton extends React.Component {
  constructor(props) {
    super(props);
  }

  resetGame = (id, eventObj) => {
    alert('Type of this: ' + (typeof this) + ' - id: ' + id);
    eventObj.stopPropagation();
  }

  render() {
    let divCallBackFunc = function () {
      alert('hi! I am div tag');
    };
    let id = 1998;
    return (
      <div onClick={divCallBackFunc}>
        <button onClick={(reactEventObj) => this.resetGame(id, reactEventObj)}>
          Reset
        </button>
      </div>
    );
  }
}

ReactDOM.render(
  <ResetButton />,
  document.getElementById('line98EntryPoint')
);</textarea>





                        </div>





</div>





                    </div>
                    <div class="lindent0a">
                        <div class="para_sep1">
                            To prevent default behavior (for example submit
                            form) just invoke method <i>preventDefault</i>.
                        </div>
                    </div>
                </div>
            </div>
            <div ID=" III.4.3 Exercises" class="para_sep1">
                <div>
                    <i>4.3 Exercises</i>
                </div>
                <div class="lindent00">
                    <div>
                        Implement <i>Button</i> component:
                    </div>
                    <div class="lindent0a">
                        Due to SDD – Software design description,
                        <a
                          target="_blank"
                          rel="noopener noreferrer"
                          href="https://huyj2ee.blogspot.com/2019/04/se-iconix-use-case-driven-design-case.html#fig_designed_class_diag"
                        >
                          <b>Figure</b> 3.3.2.1:
                          <i>System overview class diagram</i>,
                        </a>
                        <i>Button</i> stereotype is <i>Boundary</i>.
                        Thus, we will implement class <i>Button</i>
                        as React Component.
                    </div>
                    <div class="lindent0a">
                        <div>
                            As <i>II.2. Feature evolution</i> section, version 0.2
                            implements <i>Reset Game</i> use case. The first
                            subversion of this version, 0.2.1, we will implement
                            a <i>Button</i> that trigger to show an alert message
                            <i>'Game reseting...'</i>.
                        </div>
                    </div>
                    <div class="lindent0a">
                        <div>
                            As <i>I. Game introduction</i> section,
                            <i>Question 7</i>:
                        </div>
                        <div class="lindent0b">
                            <i>Button</i>'s css requires
                            customization. We will implement a <i>Button</i>
                            supports customized css name passed as component's
                            property named <i>className</i>.
                        </div>
                        <div class="lindent0b">
                            <i>Button</i>'s caption requires
                            customization. We will pass this parameter as
                            component's property named <i>caption</i>.
                        </div>
                    </div>
                </div>
                <div class="lindent00">
                    <div>
                        Source code implementation is as below,
                        github source code is also available at
                        <a
                          target="_blank"
                          rel="noopener noreferrer"
                          href="https://github.com/phamsodiep/react_line_98_game/commit/0952218ba495a312922456852361f296e0093882"
                        >
                          link.
                        </a>
                        <input
                          id="impl_exer_43$"
                          class="view_switch"
                          type="button"
                          value="content is hidden"
                          onclick="switchDisplay(this, ['index.html', 'index.js', 'content is hidden']);"
                          title="click to switch view between source code file in list: index.js, index.html"
                        />
                    </div>





<div class="impl_exer_43$index.html" style="display: none;">
                    <div class="lindent00">





<textarea id="jsxsrc:4.3:1" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Line 98</title>
  </head>
  <body>
    <style>
      div.reset_button {
        border-radius:25px;
        background:#73ad21;
        padding:20px;
        width:50px;
        height:25px;
        text-align:center
      }
    </style>
    <div id="line98ResetButton"></div>
    <br />
    <div id="line98EntryPoint"></div>
  </body>
</html></textarea>





                    </div>
</div>





<div class="impl_exer_43$index.js" style="display: none;">
                    <div class="lindent00">





<textarea id="jsxsrc:4.3:2" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
import React from 'react';
import ReactDOM from 'react-dom';

class ResetButton extends React.Component {
  resetGame() {
    alert('Game reseting...');
  }

  render() {
    let caption = this.props.caption;
    caption = typeof caption === "string" ? caption : "Reset";
    return (
      <div className={this.props.className} onClick={this.resetGame}>
        {caption}
      </div>
    );
  }
}

ReactDOM.render(
  <ResetButton className="reset_button" caption="重置" />,
  document.getElementById('line98ResetButton')
);</textarea>





                    </div>
</div>





                </div>
            </div>
        </div>
        <div ID=" III.5. State" class="para_sep1">
            <div><b>5. State</b></div>
            <div ID=" III.5.1. Concepts">
                <div>
                    <i>5.1. Concepts</i>
                </div>
                <div class="lindent00">
                    <div>
                        From OOP perspective, state are all attributes values
                        of an object. From React Component perspective, this
                        term is used with a little variant. <i>State</i> is a
                        special attributes of React Component that:
                    </div>
                    <div class="lindent0a">
                        It is local or encapsulated, it is not accessible to
                        any other component. (<i>To share it, component could
                        pass its value to child component via React properties,
                        because React properties is readonly, child component
                        could not change parent component state.</i>)
                    </div>
                    <div class="lindent0a">
                        Changing <i>state</i> values following programming
                        convention results in React Component re-render to
                        reflect this data update.
                    </div>
                </div>
            </div>
            <div ID=" III.5.2. Access">
                <div class="para_sep1">
                    <i>5.2. Access</i>
                </div>
                <div class="lindent00">
                    <div>
                        Access is done via React component class special
                        property <i>this.state</i>. For example:
                        <input
                          id="state_access_demo_52$"
                          class="view_switch"
                          type="button"
                          value="content is hidden"
                          onclick="switchDisplay(this, ['content is displayed', 'content is hidden']);"
                          title="click to show/hide State access example content"
                        />
                    </div>





<div class="state_access_demo_52$content_is_displayed" style="display: none;">
<textarea id="jsxsrc:5.2:1" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
import React from 'react';
import ReactDOM from 'react-dom';

class Counter extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
        counter: 1
    };
  }

  render() {
    return (
      <div>
        <h1>{this.state.counter}</h1>
      </div>
    );
  }
}

ReactDOM.render(
  <Hello />,
  document.getElementById('line98EntryPoint')
);</textarea>
</div>





                </div>
            </div>
            <div ID=" III.5.3. Request re-render">
                <div class="para_sep1">
                    <i>5.3. Request re-render</i>
                </div>
                <div class="lindent00">
                    Directly assigning to <i>this.state</i> property of
                    component class does not result in method <i>render()</i>
                    is invoked by React. We could request React re-render to
                    reflect this state changing by invoking to
                    <i>this.forceUpdate()</i>.
                </div>
            </div>
            <div ID=" III.5.4. Update convention">
                <div class="para_sep1">
                    <i>5.4. Update convention</i>
                </div>
                <div class="lindent00">
                    <div>
                        <i>State</i> updating could results in component
                        re-render (React invokes <i>render()</i> method), if we
                        invoke <i>this.setState()</i> method instead of directly
                        assign as <i>constructor</i> method implementation. For
                        example, below source code will re-render to display
                        updated <i>counter</i> once div tag is clicked.
                        <input
                          id="update_convention_demo_53$"
                          class="view_switch"
                          type="button"
                          value="content is hidden"
                          onclick="switchDisplay(this, ['content is displayed', 'content is hidden']);"
                          title="click to show/hide Update convention example demonstration source code"
                        />
                    </div>
                    <div class="lindent00">





<div class="update_convention_demo_53$content_is_displayed" style="display: none;">





<textarea id="jsxsrc:5.2:2" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
import React from 'react';
import ReactDOM from 'react-dom';

class Counter extends React.Component {
  constructor(props) {
    super(props);
    this.counter = 1;
    this.state = {
      caption: "Current: ",
      counter: this.counter
    };
  }

  onUpCounter = () => {
    this.counter++;
    this.setState({
      counter: this.counter
    });
  }

  render() {
    return (
      <div onClick={this.onUpCounter}>
        <h1>
          <span>{this.state.caption}</span>
          <span>{this.state.counter}</span>
        </h1>
      </div>
    );
  }
}

ReactDOM.render(
  <Hello />,
  document.getElementById('line98EntryPoint')
);
</textarea>





</div>





                    </div>
                </div>
                    <div class="lindent00">
                        <i>Note</i>: <i>this.setState()</i> method does not
                        update state entirely, it merges state instead. Thus,
                        just <i>counter</i> is merged back to
                        <i>this.state.counter</i>, the remains properties of
                        <i>this.state</i> is untouched
                        (<i>this.state.caption</i>).
                    </div>
            </div>
            <div ID=" III.5.5. Passing state to child component">
                <div class="para_sep1">
                    <i>5.5. Passing state to child component</i>
                </div>
                <div ID=" III.5.5.1. Passing state" class="lindent00">
                    <div>
                        <i>5.5.1. Passing state</i>
                    </div>
                    <div>
                        Just pass desired property of <i>this.state</i> to child
                        component via child component property. For example, as
                        below source code demonstration:
                        <input
                          id="passing_state_to_child_541$"
                          class="view_switch"
                          type="button"
                          value="content is hidden"
                          onclick="switchDisplay(this, ['content is displayed', 'content is hidden']);"
                          title="click to show/hide passing state to child component example source code"
                        />
                    </div>





<div class="passing_state_to_child_541$content_is_displayed" style="display: none;">





                    <div class="lindent00">





<textarea id="jsxsrc:5.4.1:1" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">

import React from 'react';
import ReactDOM from 'react-dom';

class ProgressIndicators extends React.Component {
  render() {
    let step = typeof this.props.percent === "number" ?
      Math.floor(this.props.percent / 10) % 11 : 0;
    let containerWidth = 120;
    let indicatorWidth = step * 12;
    let containerStyle = {
      height: 12,
      width: containerWidth,
      backgroundColor: "lightblue"
    };
    let indicatorStyle = {
      height: 12,
      width: indicatorWidth,
      backgroundColor: "black"
    };
    return (
      <div style={containerStyle}>
        <div style={indicatorStyle}>
        </div>
      </div>
    );
  }
}

class Counter extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      percent: 50
    };
  }

  render() {
    return (
      <div>
        <ProgressIndicators percent={this.state.percent} />
      </div>
    );
  }
}

ReactDOM.render(
  <Counter />,
  document.getElementById('line98EntryPoint')
);</textarea>





                    </div>





</div>





                </div>
                <div ID=" III.5.5.2. Synchronous updating for state and properties" class="lindent00">
                    <div class="para_sep1">
                        <i>
                            5.5.2. Synchronous updating for state and properties
                        </i>
                    </div>
                    <div>
                        Component rendering is based on both <i>this.state</i>
                        and <i>this.props</i>. However, <i>this.state</i> could
                        be updated by an event handler, this results in
                        <i>this.state</i> and <i>this.props</i> values are not
                        synchronized. To make sure updating is synchronized,
                        we invoke the second version of <i>this.setState()</i>
                        method which accepts a callback function as parameter.
                        React will invoke this callback function to update state
                        once the values is synchronous available. For example,
                        as below source code demonstration:
                        <input
                          id="state_properties_synchronous_updating_542$"
                          class="view_switch"
                          type="button"
                          value="content is hidden"
                          onclick="switchDisplay(this, ['content is displayed', 'content is hidden']);"
                          title="click to show/hide synchronous updating for state and properties example source code"
                        />
                    </div>
                    <div class="lindent00">





<div class="state_properties_synchronous_updating_542$content_is_displayed" style="display: none;">





<textarea id="jsxsrc:5.5.2:1" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">

import React from 'react';
import ReactDOM from 'react-dom';

class ProgressIndicators extends React.Component {
  render() {
    let step = typeof this.props.percent === "number" ?
      Math.floor(this.props.percent / 10) % 11 : 0;
    let containerWidth = 120;
    let indicatorWidth = step * 12;
    let containerStyle = {
      height: 12,
      width: containerWidth,
      backgroundColor: "lightblue"
    };
    let indicatorStyle = {
      height: 12,
      width: indicatorWidth,
      backgroundColor: "black"
    };
    return (
      <div style={containerStyle}>
        <div style={indicatorStyle}>
        </div>
      </div>
    );
  }
}

class Counter extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      percent: 0
    };
  }

  onUpCounter = () => {
    this.setState((state, props) => ({
      percent: (state.percent + 10) % 110
    }));
  }

  render() {
    return (
      <div onClick={this.onUpCounter}>
        <ProgressIndicators percent={this.state.percent} />
      </div>
    );
  }
}

ReactDOM.render(
  <Counter />,
  document.getElementById('line98EntryPoint')
);</textarea>





</div>





                    </div>
                </div>
            </div>
            <div ID=" III.5.6. Exercise">
                <div class="para_sep1">
                    <i>5.6. Exercise</i>
                </div>
                <div class="lindent00">
                    Implement version <i>0.2.2</i>, clicking reset
                    <i>Button</i> results in system initializes a
                    <i>Game Board</i> with full of <i>Ball</i>s rendered
                    in cyan colour.
                    <br />
                    <input
                      id="exercise_content_56$"
                      class="view_switch"
                      type="button"
                      value="content is hidden"
                      onclick="switchDisplay(this, ['content is displayed', 'content is hidden']);"
                      title="click to show/hide exercise 5.6. content"
                    />
                </div>





<div class="exercise_content_56$content_is_displayed" style="display: none;">





                <div class="lindent00">
                    <div>
                        Due to SDD – Software design description,
                        <a
                          target="_blank"
                          rel="noopener noreferrer"
                          href="https://huyj2ee.blogspot.com/2019/04/se-iconix-use-case-driven-design-case.html#fig_designed_class_diag"
                        >
                          <b>Figure</b> 3.3.2.1:
                          <i>System overview class diagram</i>:
                        </a>
                    </div>
                    <div class="lindent0a">
                        <i>GameBoard</i> implements <i>BallManager</i>, with
                        note that cell without ball has a null ball to listen
                        on select cell event.
                        Thus, we will implement interface <i>BallManager</i>
                        to render such null ball for <i>Reset Game</i> use case.
                    </div>
                    <div class="lindent0a">
                        Because of null balls, rendered colour is transparent.
                        However, for debug purpose, rendered colour is
                        temporary set to cyan.
                    </div>
                </div>
                <div class="lindent00">
                    <div>
                        Implementation steps are as below, github source code
                        is also available at
                        <a
                          target="_blank"
                          rel="noopener noreferrer"
                          href="#9a72622e7ffaf93197a382ab25bd6a6bfafd9c69"
                        >
                          link.
                        </a>
                    </div>
                    <div class="lindent0a">
                        <div>
                            Implement <i>resetGame()</i> method for
                            <i>GameBoard</i> (<i>BallManager</i> interface
                            of class <i>GameBoard</i>):
                            <input
                              id="reset_game_55$"
                              class="view_switch"
                              type="button"
                              value="content is hidden"
                              onclick="switchDisplay(this, ['content is displayed', 'content is hidden']);"
                              title="click to show/hide resetGame() method source code content"
                            />
                        </div>
                        <div class="lindent00">





<div class="reset_game_55$content_is_displayed" style="display: none;">
<textarea id="jsxsrc:5.6:1" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">

resetGame() {
  let dimension = 9;
  let balls = [];
  let i = 0;
  let j = 0;
  for (i = 0; i < dimension; i++) {
    balls[i] = [];
    for (j = 0; j < dimension; j++) {
      balls[i][j] = 1; // cyan colour
    }
  }
  // Update balls property of this.state by this function
  // results in this.render() method invoked by React
  this.setState((state, props) => ({
    balls: balls
  }));
}
</textarea>
</div>





                        </div>
                    </div>
                    <div class="lindent0a">
                        <div>
                            Implement to render balls:
                            <input
                              id="render_ball_55$"
                              class="view_switch"
                              type="button"
                              value="content is hidden"
                              onclick="switchDisplay(this, ['content is displayed', 'content is hidden']);"
                              title="click to show/hide resetGame() method source code content"
                            />
                        </div>
                        <div class="lindent00">





<div class="render_ball_55$content_is_displayed" style="display: none;">
<textarea id="jsxsrc:5.6:2" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">

render() {
  .....

  let balls = this.createBalls();
  return (
    <div style={containerStyle}>
      <div style={gameBoardStyle}>
        <canvas ref={this.onCanvasCreate}>
        </canvas>
        {balls}
      </div>
    </div>
  );
}

createBalls() {
  if (this.state === null) { // this.state is null if resetGame() is not invoked
    return [];
  }
  let dimension = 9;
  let balls = [];
  let i = 0;
  let j = 0;
  for (i = 0; i < dimension; i++) {
    for (j = 0; j < dimension; j++) {
      balls[balls.length] = this.createBall(i, j, this.state.balls[i][j]);
    }
  }
  return balls;
}

createBall(r, c, colourId) {
  let thick = 1;
  let cellSize = 50;
  let sz = cellSize + thick;
  let left = c * sz;
  let top = r * sz;

  return (<Ball
    left={left}
    top={top}
    colourId={colourId}
  />);
}
</textarea>
</div>





                        </div>
                    </div>





                    <div class="lindent0a">
                        <div>
                            Implement to invoke <i>resetGame()</i> once
                            <i>ResetButton</i> is clicked:
                            <input
                              id="reset_game_trigger_55$"
                              class="view_switch"
                              type="button"
                              value="content is hidden"
                              onclick="switchDisplay(this, ['content is displayed', 'content is hidden']);"
                              title="click to show/hide resetGame() method source code content"
                            />
                        </div>
                        <div class="lindent00">





<div class="reset_game_trigger_55$content_is_displayed" style="display: none;">
<textarea id="jsxsrc:5.6:3" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
// Save GameBoard reference to gameBoardRef global variable
var gameBoardRef = ReactDOM.render(
  <GameBoard />,
  document.getElementById('line98EntryPoint')
);

class ResetButton extends React.Component {
  .....

  resetGame() {
    //alert('Game reseting...');
    // invoke GameBoard reference resetGame() method
    gameBoardRef.resetGame();
  }
}
</textarea>
</div>





                        </div>
                    </div>
                    <div class="lindent0a">
                        <div>
                            Implement class <i>Ball</i>:
                            <input
                              id="ball_class_55$"
                              class="view_switch"
                              type="button"
                              value="content is hidden"
                              onclick="switchDisplay(this, ['content is displayed', 'content is hidden']);"
                              title="click to show/hide resetGame() method source code content"
                            />
                        </div>
                        <div class="lindent00">





<div class="ball_class_55$content_is_displayed" style="display: none;">
<textarea id="jsxsrc:5.6:4" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">

const COLOUR_LIST = [
  null,
  "#00ccff",
  "#ffff00",
  "#33cc33",
  "#0000ff",
  "#cc3300",
  "#ff66ff",
  "#ff9900"
];

class Ball extends React.Component {
  getColourId() {
    return this.props.colourId >= 0 && this.props.colourId <= 7 ?
      this.props.colourId : 0;
  }

  getCellStyle() {
    let thick = 1;
    let cellSize = 50;
    let size = cellSize + thick;

    return {
      display: "flex",
      alignItems: "center",
      justifyContent: "center",
      margin: "auto",
      position: "absolute",
      width: size,
      height: size,
      left: this.props.left,
      top: this.props.top
    };
  }

  deriveBallStyle(colourId) {
    let thick = 1;
    let cellSize = 50;
    let size = cellSize + thick;
    let ballSize = Math.floor(size * 60.0 / 100.0);

    return {
      display: "block",
      width: ballSize + "px",
      height: ballSize + "px",
      background: COLOUR_LIST[colourId],
      borderRadius: "50%",
      padding: "0px",
      borderWidth: "0px",
      borderStyle: "none",
    };
  }

  render() {
    let colourId = this.getColourId();
    let cellStyle = this.getCellStyle();
    let ballStyle = this.deriveBallStyle(colourId);

    return (
      <div style={cellStyle}>
        <div style={ballStyle}>
        </div>
      </div>
    );
  }
}
</textarea>
</div>





                        </div>
                    </div>




                </div>
                <div class="lindent00">
                    <div>
                        <i>Side effect of 'this.setState'</i>:
                    </div>
                    <div class="lindent0a">
                        <div>
                            <i>Side effect</i>: Invoking
                            <i>this.resetGame()</i> in <i>constructor</i>
                            context of component class <i>GameBoard</i> does
                            not results in first render of <i>GameBoard</i>
                            has full of Balls rendered in cyan colour.
                            Because invoking:
                        </div>
                        <div class="lindent00">





<textarea id="jsxsrc:5.6:5" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
this.setState((state, props) => ({
  balls: balls
}));</textarea>





                        </div>
                        <div>
                            does not update state immediately. It just schedules
                            an update with a callback function. In the case of
                            <i>constructor</i> context, <i>render()</i> method
                            will be invoked before this state update.
                        </div>
                    </div>
                    <div class="lindent0a">
                        <div>
                            <i>Solution</i>:
                        </div>
                        <div class="lindent0b">
                            <div>
                                <i>resetGame</i> method implementation should
                                assign <i>this.state</i> component class
                                property directly for <i>constructor</i>
                                <i>resetGame</i> effect (<i>Browser actor
                                initiates  Reset Game use case</i>).
                            </div>
                            <div class="lindent00">





<textarea id="jsxsrc:5.6:6" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
this.state = {
  balls: balls
};</textarea>





                            </div>
                        </div>
                        <div class="lindent0b">
                            <div>
                                <i>resetGame</i> method implementation invokes
                                method <i>this.forceUpdate()</i> for
                                <i>ResetButton</i> event handler effect
                                (<i>Player actor initiates Reset Game use case
                                by button clicking</i>).
                            </div>
                            <div class="lindent00">





<textarea id="jsxsrc:5.6:7" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
this.state = {
  balls: balls
};
this.forceUpdate();</textarea>





                            </div>
                        </div>
                    </div>
                    <div class="lindent0a">
                        <div>
                            <i>Final source code:</i>
                        </div>
                        <div class="lindent00">
                            Final source code with this side effect fixing is
                            as below, github source code is also available at
                            <a
                              target="_blank"
                              rel="noopener noreferrer"
                              href="https://github.com/phamsodiep/react_line_98_game/commit/2e2fb708b6568167e8449c1dfcc56257da6a5cdb"
                            >
                              link.
                            </a>
                            <br />
                            <input
                              id="side_effect_fixing_56$"
                              class="view_switch"
                              type="button"
                              value="content is hidden"
                              onclick="switchDisplay(this, ['content is displayed', 'content is hidden']);"
                              title="click to show/hide side effect fixing source code"
                            />
                        </div>
                        <div class="lindent00">





<div class="side_effect_fixing_56$content_is_displayed" style="display: none;">
<textarea id="jsxsrc:5.6:8" rows="10" cols="80"  class="txt_sourcecodefont0" readonly="true" style="display: none;">
import React from 'react';
import ReactDOM from 'react-dom';


const COLOUR_LIST = [
  null,
  "#00ccff",
  "#ffff00",
  "#33cc33",
  "#0000ff",
  "#cc3300",
  "#ff66ff",
  "#ff9900"
];

class ResetButton extends React.Component {
  resetGame() {
    gameBoardRef.resetGame();
  }

  render() {
    let caption = this.props.caption;
    caption = typeof caption === "string" ? caption : "Reset";
    return (
      <div className={this.props.className} onClick={this.resetGame}>
        {caption}
      </div>
    );
  }
}

class Ball extends React.Component {
  getColourId() {
    return this.props.colourId >= 0 && this.props.colourId <= 7 ?
      this.props.colourId : 0;
  }

  getCellStyle() {
    let thick = 1;
    let cellSize = 50;
    let size = cellSize + thick;

    return {
      display: "flex",
      alignItems: "center",
      justifyContent: "center",
      margin: "auto",
      position: "absolute",
      width: size,
      height: size,
      left: this.props.left,
      top: this.props.top
    };
  }

  deriveBallStyle(colourId) {
    let thick = 1;
    let cellSize = 50;
    let size = cellSize + thick;
    let ballSize = Math.floor(size * 60.0 / 100.0);

    return {
      display: "block",
      width: ballSize + "px",
      height: ballSize + "px",
      background: COLOUR_LIST[colourId],
      borderRadius: "50%",
      padding: "0px",
      borderWidth: "0px",
      borderStyle: "none",
    };
  }

  render() {
    let colourId = this.getColourId();
    let cellStyle = this.getCellStyle();
    let ballStyle = this.deriveBallStyle(colourId);

    return (
      <div style={cellStyle}>
        <div style={ballStyle}>
        </div>
      </div>
    );
  }
}

class GameBoard extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      balls: []
    };
    this.resetGame();
  }

  onCanvasCreate = (bgImg) => {
    let i = 0;
    let n = 9; // dimension
    let thick = 1;
    let cellSize = 50;
    let width = n * cellSize + thick * (n + thick);

    // Context retrieving and initializing
    bgImg.width = width;
    bgImg.height = width;
    bgImg.style.position = "absolute";
    bgImg.style.left = 0;
    bgImg.style.top = 0;
    let canvasContext = bgImg.getContext("2d");
    canvasContext.translate(0, 0);
    canvasContext.lineWidth = 1;

    // Render board surface
    canvasContext.fillStyle = "#eeeeee";
    canvasContext.fillRect(
      0,
      0,
      width,
      width
    );

    // Render board cells border
    // |  |  |...
    canvasContext.fillStyle = "#000000";
    for (i = 0; i <= n; i++) {
      let x = i * (cellSize + thick);
      canvasContext.fillRect(x, 0, thick, width);
    }
    // =
    for (i = 0; i <= n; i++) {
      let y = i * (cellSize + thick);
      canvasContext.fillRect(0, y, width, thick);
    }
  }

  render() {
    // dimension * cellSize + lineWidth * (dimension + 1)
    let width = 9 * 50 + 1 * (9 + 1);
    let gameBoardStyle = {
      position: "relative",
      width: "100%",
      height: "100%",
      borderWidth: "0px",
      borderStyle: "none",
      margin: "0px 0px 0px 0px",
      padding: "0px 0px 0px 0px"
    };
    let containerStyle = {
      position: "static",
      width: width + "px",
      height: width + "px",
      borderWidth: "0px",
      borderStyle: "none",
      margin: "0px 0px 0px 0px",
      padding: "0px 0px 0px 0px"
    };
    let balls = this.createBalls();

    return (
      <div style={containerStyle}>
        <div style={gameBoardStyle}>
          <canvas ref={this.onCanvasCreate}>
          </canvas>
          {balls}
        </div>
      </div>
    );
  }


  //////////////////////////////////////////////////////////////////////////////
  // BallManager interface
  //////////////////////////////////////////////////////////////////////////////
  resetGame() {
    let dimension = 9;
    let i = 0;
    let j = 0;
    for (i = 0; i < dimension; i++) {
      this.state.balls[i] = [];
      for (j = 0; j < dimension; j++) {
        this.state.balls[i][j] = 1; // cyan colour
      }
    }
    this.forceUpdate();
  }

  createBalls() {
    if (this.state === null) { // this.state is null if resetGame() is not invoked
      return [];
    }
    let dimension = 9;
    let balls = [];
    let i = 0;
    let j = 0;
    for (i = 0; i < dimension; i++) {
      for (j = 0; j < dimension; j++) {
        balls[balls.length] = this.createBall(i, j, this.state.balls[i][j]);
      }
    }
    return balls;
  }

  createBall(r, c, colourId) {
    let thick = 1;
    let cellSize = 50;
    let sz = cellSize + thick;
    let left = c * sz;
    let top = r * sz;

    return (<Ball
      left={left}
      top={top}
      colourId={colourId}
    />);
  }
}

var gameBoardRef = ReactDOM.render(
  <GameBoard />,
  document.getElementById('line98EntryPoint')
);

ReactDOM.render(
  <ResetButton className="reset_button" caption="重置" />,
  document.getElementById('line98ResetButton')
);
</textarea>
                        <input
                          class="view_switch"
                          type="button"
                          value="hide final source code"
                          onclick="document.getElementById('side_effect_fixing_56$').click();"
                          title="click to hide final source code of exercise 5.6"
                        />
</div>





                        </div>
                    </div>
                </div>
            </div>





</div>





        </div>
    </div>
    <div ID=" ???. References" class="para_sep1">
        <div>
            <b>???. References</b>
        </div>
        <div class="lindent0a">
            <i>React tutorial</i>: https://reactjs.org/docs/hello-world.html
        </div>
        <div class="lindent0a">
            <div><i>React documents</i>:</div>
            <div>
                <div class="lindent0a">
                    <a
                      target="_blank"
                      rel="noopener noreferrer"
                      href="https://reactjs.org/docs/refs-and-the-dom.html"
                    >
                      Refs and the DOM
                    </a>
                </div>
            </div>
        </div>
        <div class="lindent0a">
            <i>Stack overflow</i>: https://stackoverflow.com/
        </div>
    </div>
</div>


<div id="githubsrc" class="hidden">Source: https://github.com/phamsodiep/blogger/blob/master/phamsodiep/js-jsx-react-in-a-nutshell.htm</div>
<div id="githubver" class="hidden">0.0.5</div>
<script>doDefaultDecorate();</script>
<script>
function doScrollIntoViewDecoration() {
  let topLvElem = document.getElementById("entry_article");
  // Extract targetId
  let targetId = "";
  let curUrl = window.location.href;
  let idx = curUrl.length;
  for (let ch = curUrl.charAt(--idx); ch !== '/'; ch = curUrl.charAt(--idx)) {
    if(ch === "#") {
      targetId = curUrl.substring(idx + 1);
      break;
    }
  }
  // id prefixed with 'cmd_' is reserved to command param sent to app
  let isCmd = targetId.startsWith("cmd_");
  if (isCmd) {
    return;
  }
  // retrieve element
  let targetElem = document.getElementById(targetId);
  if (!(targetElem !== null && topLvElem !== null)) {
    return;
  }
  // travel up and search for hidden div
  let classNames = [];
  let groups = [];
  let stateNames = [];
  for (let elem = targetElem.parentNode; elem !== topLvElem; elem = elem.parentNode) {
    if (elem.nodeName === "DIV" &&  elem.style.display === "none") {
      let className = elem.className;
      let endIdx = className.indexOf("$");
      if (endIdx >= 0) {
        classNames[classNames.length] = className;
        groups[groups.length] = className.substring(0, endIdx);
        stateNames[stateNames.length] =
          className.substring(endIdx + 1).split("_").join(" ");
      }
    }
  }
  // do decoration by clicking button
  for(let i = 0; i < groups.length; i++) {
    let elemId = groups[i] + "$";
    let elem = document.getElementById(elemId);
    if (elem !== null) {
      for (
        let curStateName = elem.value.toString();
        curStateName !== stateNames[i];
        curStateName = elem.value.toString()
      ) {
        elem.click();
      }
    }
  }
  // Scroll to
  targetElem.scrollIntoView();
}
doScrollIntoViewDecoration();


const DiepSrcCode = {
  FORMAT_JAVA: 0,
  FORMAT_JS: 1,

  FORMATS: [
    // FORMAT_JAVA
    [
      ["  ", "&nbsp;&nbsp;"],
      ["package", "<b style='color: olive;'>package</b>"],
      ["import", "<b style='color: olive;'>import</b>"],
      ["public", "<b style='color: green;'>public</b>"],
      ["private", "<b style='color: green;'>private</b>"],
      ["void", "<b style='color: green;'>void</b>"],
      ["for", "<b style='color: maroon;'>for</b>"],
      ["if", "<b style='color: maroon;'>if</b>"],
      ["this", "<b style='color: maroon;'>this</b>"],
      ["return", "<b style='color: maroon;'>return</b>"]
    ],
    // FORMAT_JS
    [
      ["  ", "&nbsp;&nbsp;"],
      // keywords
      ["import[ ]", "<b style='color: blue;'>import</b>&nbsp;"],
      ["export[ ]", "<b style='color: blue;'>export</b>&nbsp;"],
      ["class[ ]", "<b style='color: blue;'>class</b>&nbsp;"],
      ["extends[ ]", "<b style='color: blue;'>extends</b>&nbsp;"],
      ["super[(]", "<b style='color: blue;'>super</b>("],
      ["new[ ]", "<b style='color: blue;'>new</b>&nbsp;"],
      ["constructor[(]", "<b style='color: darkgoldenrod;'>constructor</b>("],
      ["[ ]undefined", "&nbsp;<b style='color: blueviolet;'>undefined</b>"],
      ["[ ]null", "&nbsp;<b style='color: blue;'>null</b>"],
      ["[ ]false", "&nbsp;<b style='color: blue;'>false</b>"],
      ["[ ]true", "&nbsp;<b style='color: blue;'>true</b>"],
      ["const[ ]", "<b style='color: blue;'>const</b>&nbsp;"],
      ["let[ ]", "<b style='color: blue;'>let</b>&nbsp;"],
      ["var[ ]", "<b style='color: blue;'>var</b>&nbsp;"],
      ["for[ ]", "<b style='color: blue;'>for</b>&nbsp;"],
      ["if[ ]", "<b style='color: blue;'>if</b>&nbsp;"],
      ["else[ ]", "<b style='color: blue;'>else</b>&nbsp;"],
      ["switch[(]", "<b style='color: blue;'>switch</b>("],
      ["case[ ]", "<b style='color: blue;'>case</b>&nbsp;"],
      ["break", "<b style='color: blue;'>break</b>"],
      ["default:", "<b style='color: blue;'>default</b>:"],
      ["this", "<b style='color: blue;'>this</b>"],
      ["return[ ]", "<b style='color: blue;'>return</b>&nbsp;"],
      ["typeof[ ]", "<b style='color: blue;'>typeof</b>&nbsp;"],
      ["function[ ]", "<b style='color: blue;'>function</b>&nbsp;"],

      // objects
      ["document[.]", "<b style='color: darkgoldenrod;'>document</b>."],
      ["Array", "<b style='color: blueviolet;'>Array</b>"],
      ["Math[.]", "<b style='color: blueviolet;'>Math</b>."],
      //["Object", "<b style='color: blueviolet;'>Object</b>"],
      // methods
      ["toString[(][)]", "<b style='color: blueviolet;'>toString</b>()"],
      ["setTimeout[(]", "<b style='color: darkgoldenrod;'>setTimeout</b>("],
      ["alert[(]", "<b style='color: darkgoldenrod;'>alert</b>("],
      ["Object.assign[(]",
        [
          "<b style='color: blueviolet;'>Object</b>",
          ".",
          "<b style='color: darkgoldenrod;'>assign</b>("
        ].join("")
      ],
      ["[\u262F]", ""]
    ]
  ],

  commentedOutHtmlWrap: function (s, skipBreak) {
    if (skipBreak) {
        return "<i style='color: teal;'>".concat(s, "</i>");
    }
    return "<i style='color: teal;'>".concat(s, "</i><br />");
  },

  formatLine: function (formatId, line, skipBreak) {
    let formats = DiepSrcCode.FORMATS[formatId];
    for (let j = 0; j < formats.length; j++) {
        let format = formats[j];
        let regExp = new RegExp(format[0], 'g');
        line = line.replace(regExp, format[1])
    }
    if (skipBreak) {
        return line;
    }
    return line.concat("<br />");
  },

  processCommentedOut: function (line, formatId) {
    let idx = line.indexOf("//");
    if (idx >= 0) {
        let html =
          DiepSrcCode.formatLine(formatId, line.substring(0, idx), true);
        html = html.concat(
          DiepSrcCode.commentedOutHtmlWrap(line.substring(idx, line.length))
        );
        return [true, html];
    }
    idx = line.indexOf("/*");
    if (idx >= 0) {
        let html =
          DiepSrcCode.formatLine(formatId, line.substring(0, idx), true);
        html = html.concat(
          DiepSrcCode.commentedOutHtmlWrap(line.substring(idx, line.length))
        );
        return [false, html];;
    }
    return null;
  },

  detectCommentedOutClose: function (line, formatId) {
      let idx = line.indexOf("*/");
      if (idx >= 0) {
          idx += 2;
          let html =
            DiepSrcCode.commentedOutHtmlWrap(line.substring(0, idx), true);
          html = html.concat(
            DiepSrcCode.formatLine(formatId, line.substring(idx, line.length))
          );
          return [false, html];
      }
      return [true, DiepSrcCode.commentedOutHtmlWrap(line)];
  },

  escapeJSX: function (txtId) {
    let txtComp = document.getElementById(txtId);
    if (txtComp !== null) {
      let str = txtComp.value.toString();
      let regExp = new RegExp("[<]", 'g');
      str = str.replace(regExp, "&lt;");
      regExp = new RegExp("[>]", 'g');
      str = str.replace(regExp, "&gt;");
      txtComp.value = str;
    }
  },

  fillCFamilySourceCode: function (txtId, formatId) {
    // parse and convert source code
    let html = "";
    let txtComp = document.getElementById(txtId);
    let onCommentedOut = false;
    if (txtComp) {
      let lines = txtComp.value.split(/\r?\n/);
      for (let i = 0; i < lines.length; i++) {
          let line = lines[i];
          if (onCommentedOut) {
              let detect = DiepSrcCode.detectCommentedOutClose(line, formatId);
              onCommentedOut = detect[0];
              html = html.concat(detect[1]);
              continue;
          }
          let commentedOut = DiepSrcCode.processCommentedOut(line, formatId);
          if (commentedOut == null) {
              html = html.concat(DiepSrcCode.formatLine(formatId, line));
          }
          else {
              if (commentedOut[0]) {
                  html = html.concat(commentedOut[1]);
              }
              else {
                  html = html.concat(commentedOut[1]);
                  onCommentedOut = true;
              }
          }
      }

      // apply converted source code to target div
      let divElement = document.createElement("DIV");
      divElement.innerHTML = html;
      divElement.className = "txt_sourcecodefont1";
      txtComp.parentNode.insertBefore(divElement, txtComp);
    }
  }
};

let snippets  = document.querySelectorAll('*[id^="jsxsrc:"]');
for (let i = 0; i<snippets.length; i++) {
  let id = snippets[i].id;
  DiepSrcCode.escapeJSX(id);
  DiepSrcCode.fillCFamilySourceCode(id, DiepSrcCode.FORMAT_JS);
}
</script>
</div>

